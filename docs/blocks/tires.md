# Tires

The Tires section defines the tire friction curve for the wheels in the vehicle.

![Vehicle Physics Pro tires inspector](/img/blocks/vpp-tires-inspector.png){: .clickview }

Horizontal axis
:	Slip velocity in m/s (each vertical green line is 1 m/s), that is, the wheel speed difference at
	the contact patch.

Vertical axis
:	Coefficient of friction ($\mu$) as function of the actual slip velocity. A small slip velocity
	increases the coefficient of friction up to the tire's peak friction. Increasing the slip
	beyond that peak point decreased the friction to lower values.

The characteristic values of the tire friction curve are shown below the graph:

Adherent ($\mu_a$)
:	Coefficient of friction at adherent state (i.e. vehicle stopped and braked) and low slip
	velocities up to the given m/s value.

Peak ($\mu_p$)
:	Maximum friction that can be developed by the tire. This friction is produced only at the given
	slip velocity.

Limit ($\mu_l$)
:	Minimum friction produced when the tire is heavily sliding beyond the given slip velocity.
	The coefficient of friction smoothly varies from the peak to the limit with the slip and
	remains constant beyond.

This is the default tire friction curve in VPP:

![Vehicle Physics Pro default tires](/img/blocks/vpp-tires-inspector-default.png){: .clickview }

- For slips < 0.5 m/s the coefficient of friction is 0.95
- For slips > 0.5 m/s the coefficient of friction increases progressively up to 1.1 at 1.5 m/s.
- For slips > 1.5 m/s the coefficient of friction decreases progressively down to 0.8 at 4 m/s
- For slips > 4 m/s the coefficient remains constant at 0.8

The default tire setup is very forgiving and allows a good control of the vehicle in most situations.

A competition tire looks more like this:

![Vehicle Physics Pro competition tire](/img/blocks/vpp-tires-inspector-competition.png){: .clickview }

In this tire the peak friction (1.1) is reached at just 0.6 m/s. Any slip beyond that, and the
friction rapidly drops 0.6. Real racing drivers have a great ability to apply the correct throttle
to keep the tire at its maximum friction.

A more realistic friction shape can be achieved using the Pacejka friction model:

![Vehicle Physics Pro competition tire](/img/blocks/vpp-tires-inspector-pacejka.png){: .clickview }

In this case Stiffness value to configures the slip where the curve reaches the peak friction at.

---

### Understanding grip, torque and acceleration

Torque is applied to the wheel. The tire converts the torque into a force at the contact point. This
force is then applied to the rigidbody, causing acceleration and the actual motion of the vehicle.

The torque is generated by the engine and drivetrain connected to the drive wheels. While this
torque can be nearly any magnitude, the **grip** actually limits the amount of force that is
transmitted to the vehicle:

$$
Grip = F_z \times{\mu}
$$

where

$Grip$ (N) is the maximum force the tire can transmit to the vehicle,
{: .indent }

$F_z$ (N) is vertical downforce on the tire, and
{: .indent }

$\mu$ is the coefficient of friction of the tire with the surface.
{: .indent }

The force $F_z$ supported by the wheel depends on several factors: weight, acceleration,
aerodynamics. When the vehicle is accelerating part of its weight is transfered from front to rear
wheels. RWD (Rear Wheel Drive) vehicles have better acceleration because of the increased downforce
on the drive wheels while accelerating provides extra grip. When the vehicle is braking part of the
weight is transfered to the front wheels which get their grip increased while braking. This is why
brake systems typically apply more brake power to the front wheels (_brake bias_).

!!! Info "&fa-thumbs-o-up; Tip"
	The more weight the more grip but also less acceleration due to the vehicle's mass. As rule of
	thumb an acceleration of 1G requires all the wheels to perform a coefficient of friction of
	$\mu = 1$.

The coefficient of friction $\mu$ is given by the tire friction curve combined with the amount of
slip. A simplified friction curve depends on the surface grip only. A realistic curve depends on
many factors: camber, temperature, pressure, surface grip, vertical downforce, tire wear...

Aerodynamics have a huge influence on grip because it greatly increments $F_z$ at high speeds.
Formula-1 vehicles can achieve a sustained lateral acceleration of 4G at high speed curves. Without
the effect of aerodynamics this would mean tires with coefficient of friction $\mu$ of 4. Typical
road tires can reach 1. Racing slick tires can perform in the range of 1.7 - 1.9. Only aerodynamics
can increase the grip further.

When the torque is greater than the grip of the wheel, the excess of torque causes wheel spin, and
the tire slips over the surface. In typical friction curves exceeding certain slip value reduces
the grip. In addition, forward slip reduces the tire's sideways grip so the vehicle can easily
slide sideways.

!!! Info "&fa-thumbs-o-up; Tips for improving grip and acceleration"
	- Keep forward slip under control. A rev limiter can be set up in the engine so the first gear
		gets a controlled amount of spin, limiting the slip on standing starts.
	- The Traction Control System (TCS) cuts the engine power for limiting the forward slip and thus
		increase the grip.
	- Use aerodynamics for increasing grip at high speeds. Aerodynamic components must produce a
		balanced downforce among front and rear axles.
	- Rear-Wheel-Drive and All-Wheel-Drive vehicles have better acceleration than Front-Wheel-Drive
		vehicles.

### Steering, friction, lateral slip and lateral forces

Here's a step-by-step explanation of the different factors involved on lateral tire forces and
cornering rate:

![Vehicle Physics Pro Telemetry](/img/blocks/vehicle-physics-pro-steering-telemetry-annotated.png)

- Steering angle is 29 - 22 degrees for the front wheels **(1)**
- Speed is 106.3 km/h or 66 mph **(5)**
- Given the above steering angle and speed, the wheels are experiencing a lateral slip of 12 - 10
	m/s **(4)**
- The slip applied to the tire friction curve results in a coefficient of friction of ~0.82
	(not shown at the telemetry; more info below).
- Normal load on the wheels is 1952 - 4955 N **(2)**
- Given the above coefficient of friction and normal load, the wheels produce a lateral force of
	1611 - 4178 N **(3)**
- The lateral forces applied to the vehicle produce an angular rotation rate of 0.30 rad/s or 17.2
	deg/s **(6)**. This means that at this speed the vehicle could complete a 90ยบ turn in ~5.2 seconds.

This is the tire friction curve in the vehicle:

![Vehicle Physics Pro Tire Friction Curve](/img/blocks/vehicle-physics-pro-tire-friction-curve.png)

The peak friction is developed at 1.5 m/s. As the front wheels are experiencing 10-12 m/s, this
means they are developing the minimum friction (a coefficient of friction of ~0.82).

!!! Info "&fa-thumbs-o-up; Maximizing the lateral forces"

	- Use the Steering Limit aid for keeping the sideways slip close to the value where the maximum
		friction is developed. For example, a steering angle of 3 degrees in the scene above
		increases the cornering rate to 0.50 rad/s (= 28.6 deg/s, or just 3.15 seconds for
		completing a 90ยบ turn).
	- Adjust the tire friction curve so the maximum friction is developed at a value more closer to
		the typical sideways slip experienced by wheels. Combine this solution with the previous
		one.
	- Configure the aerodynamic components to apply more downforce at the front wheels than at the
		rear wheels at high speeds. This may increase oversteer as well.
		rear wheels at high speeds. This may increase oversteer as well.

### Slip ratio and slip angle

There are lots of papers, docs, etc. about tires and slip ratio / slip angle. _"Don't reinvent the
wheel"_ is a good lesson, but this time I strongly believe that the wheel needed to be reinvented
for most racing games and vehicle simulations.

**The fact** is that slip ratio and slip angle concepts are *not* required at all for simulating
tires and vehicles. Vehicle Physics Pro uses a tire simulation model that doesn't use these concepts
at all, yet providing fully accurate and realistic results. I've conceived a tire model where all
frictions, forces and torques can be calculated in a much easier and consistent way.

Here's a quote from my article [Facts and Myths of the Pacejka curves](http://www.edy.es/dev/2011/12/facts-and-myths-on-the-pacejka-curves/),
which is indeed based on Brian Beckman's thoughts about the Magic Formula not accounting for any
variation of the force with speed (reference: [The Physics Of Racing, chapter 22](http://phors.locost7.info/phors22.htm)):

> The lateral force is based on the slip angle. However the slip angle does not account for any
> variation with the speed. Intuitively, the forces generated at high speed must be greater than
> the forces at low speed with the same slip angles. But V = (0.2, 0.1) results in the same slip
> angle (and thus the same force) as V = (20, 10).

Also, the widely used slip ratio formulas fail to describe tire grip at very different speeds. At
10 m/s a slip ratio of 10% represents 1 m/s of speed difference at the contact patch. But at 40 m/s
the same slip ratio represents 4 m/s of speed difference at the contact patch. Intuitively, this
slip ratio of 10% cannot result in the same tire grip in both situations.

In my opinion the slip ratio and slip angle concepts belong to the automotive and tire industries.
They are used to make studies, write standards, specifications, etc. but they are hard to fit into
games and vehicle simulations in a coherent way. Slip ratio, slip angle and all their related
stuff are required if you need your simulation to match exactly the real specifications and product
details given by tire and automotive manufacturers, as they use these standards for exchanging
information.

For instance, if you want your simulation to reproduce exactly the tire model XXX from manufacturer
YYY then you need to use the slip ratio and slip angle concepts because the manufacturer will
provide the specifications and measures on that tire using these concepts and standards.

Even so, these standards are not applicable to many common situations such as low speeds and steady
states. These situations must still be "faked" and threated separately in the simulation. Racing
games are mostly in the "high speed" mode, so they don't care. But many common non-racing situations
produce incoherent results using the slip ratio and slip angle concepts.

&fa-info-circle:lg; The tire model developed for Vehicle Physics Pro provides perfectly coherent behaviors at any speed,
with perfectly defined continuous transitions between any state.
{: .alert .alert-info }

### Converting an existing Pacejka set to VPP

Standard Pacejka sets are based on _slip ratio_ and _slip angle_ while friction curves in VPP are
based in _slip velocity_. Thus, standard Pacejka coefficients are not directly compatible with VPP.
Still, existing Pacejka sets may be adapted to VPP following this procedure:

1. Define a velocity $V$ for the vehicle and a vertical load $N$. Ideally, these should be the same
	values used for extracting the original Pacejka coefficients out of the real tire. If they are
	not available, use some representative velocity and load from the ranges the tire is designed to
	operate at.

2. Use some math software (Mathematica, Matlab) to draw the normalized tire friction curve:

	$$\mu(x, V, N) = \frac{P(s, N)}{N}$$

	$P(s, N)$ is the force computed out of the Pacejka set being $N$ the vertical load, and $s$ the
	_slip ratio_ ($\sigma$) for the longitudinal Pacejka version, or the _slip angle_ ($\alpha$)
	for the lateral version:

	\begin{align}
	\sigma &= \frac{x - V}{\vert{V}\vert} \\
	\alpha &= \tan^{-1} (\frac{x}{V})
	\end{align}

	where $x$ is horizontal value in the graph. So the longitudinal version would be:

	$$\mu(x, V, N) = \frac{P(\frac{x - V}{\vert{V}\vert}, N)}{N}$$

	And the lateral version:

	$$\mu(x, V, N) = \frac{P(\tan^{-1} (\frac{x}{V}), N)}{N}$$

3. Configure the tire friction in VPP to match the resulting curve as closely as possible. You may
	use either a Pacejka model or any of the other modes (i.e. Parametric), which are typically
	easier to fit to an existing curve.
